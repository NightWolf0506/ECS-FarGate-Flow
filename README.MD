# ğŸš€ Strapi CMS Deployment on AWS ECS Fargate using Terraform & GitHub Actions

This project automates the deployment of a Strapi backend to **AWS ECS Fargate** using:

- ğŸ³ Docker (containerized build)
- â˜ï¸ AWS ECS Fargate (serverless container service)
- ğŸ“¦ Docker Hub (image hosting)
- ğŸ”§ Terraform (infrastructure as code)
- ğŸ¤– GitHub Actions (CI/CD pipeline)

---

## ğŸ“ Project Structure

```
Repo/
â”œâ”€â”€ .github/workflows/
â”‚   â””â”€â”€ deploy.yml          # CI/CD pipeline: Docker build, push & deploy via Terraform
â”œâ”€â”€ docker/
â”‚   â””â”€â”€ Dockerfile          # Dockerfile for production Strapi build
â”œâ”€â”€ terraform/
â”‚   â””â”€â”€ main.tf             # Terraform to provision ECS cluster, task, service & SG
â”œâ”€â”€ Strapi-Aryan/
â”‚   â”œâ”€â”€ package.json        # Strapi backend code
â”‚   â””â”€â”€ .dockerignore       # Docker ignore for build context
â””â”€â”€ README.md
```

---

## âš™ï¸ Setup Instructions

### ğŸ” 1. Create GitHub Secrets

In your GitHub repository settings, add the following secrets:

| Secret Name              | Description                             |
|--------------------------|-----------------------------------------|
| `DOCKER_USERNAME`        | Your Docker Hub username                |
| `DOCKER_PASSWORD`        | Your Docker Hub password/token          |
| `DOCKER_REPO`            | Full repo name (e.g. `username/image`)  |
| `AWS_ACCESS_KEY_ID`      | IAM access key for AWS                  |
| `AWS_SECRET_ACCESS_KEY`  | IAM secret key for AWS                  |
| `AWS_REGION`             | AWS region (e.g. `us-east-1`)           |
| `HOST`                   | Strapi host (`0.0.0.0`)                 |
| `PORT`                   | Strapi port (`1337`)                    |
| `APP_KEYS`               | Strapi app keys                         |
| `API_TOKEN_SALT`         | Strapi API token salt                   |
| `ADMIN_JWT_SECRET`       | Strapi admin JWT secret                 |
| `TRANSFER_TOKEN_SALT`    | Strapi transfer token salt              |
| `JWT_SECRET`             | JWT secret                              |
| `ENCRYPTION_KEY`         | Strapi encryption key                   |

---

### ğŸš€ 2. CI/CD Deployment Workflow

Each push to `main` will:

1. Build the Docker image from `Strapi-Aryan/`
2. Push to Docker Hub: `${{ secrets.DOCKER_REPO }}:latest`
3. Use Terraform to:
   - Provision a security group
   - Deploy ECS Fargate cluster, task, and service
   - Expose port 1337 to the internet

> ğŸŒ Result: Access your Strapi CMS at `http://<ECS-Public-IP>:1337`

---

## ğŸ“¦ Docker (Local Build & Run)

```bash
docker build -f docker/Dockerfile -t strapi-app ./Strapi-Aryan
docker run -p 1337:1337 strapi-app
```

---

## ğŸŒ Terraform (Manual Deploy)

```bash
cd terraform
terraform init
terraform apply
```

âœ… Output: ECS public IP where Strapi is running.

---

## ğŸ§¼ Cleanup

To destroy all AWS resources:

```bash
cd terraform
terraform destroy
```

---

## ğŸ› ï¸ Notes

- ECS Fargate = zero EC2 hassle âœ…
- All secrets are inject
